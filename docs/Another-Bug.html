<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.0.3, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is An Introduction to Programming in Emacs Lisp, for
people who are not programmers.


Distributed with Emacs version 29.1.

Copyright Â© 1990-1995, 1997, 2001-2023 Free Software
Foundation, Inc.



Printed copies available from https://shop.fsf.org/. Published by:

GNU Press,                        https://www.fsf.org/licensing/gnu-press/
a division of the                 email: sales@fsf.org
Free Software Foundation, Inc.    Tel: +1 (617) 542-5942
51 Franklin Street, Fifth Floor   Fax: +1 (617) 542-2652
Boston, MA 02110-1301 USA


ISBN 1-882114-43-4

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; there
being no Invariant Section, with the Front-Cover Texts being "A GNU
Manual", and with the Back-Cover Texts as in (a) below.  A copy of
the license is included in the section entitled "GNU Free
Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." -->
<title>Another Bug (Programming in Emacs Lisp)</title>

<meta name="description" content="Another Bug (Programming in Emacs Lisp)">
<meta name="keywords" content="Another Bug (Programming in Emacs Lisp)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Print-Whole-Graph.html" rel="up" title="Print Whole Graph">
<link href="Final-printed-graph.html" rel="next" title="Final printed graph">
<link href="mapcar.html" rel="prev" title="mapcar">
<style type="text/css">
<!--
div.example {margin-left: 3.2em}
span.r {font-family: initial; font-weight: normal; font-style: normal}
-->
</style>


</head>

<body lang="en">
<div class="appendixsubsec-level-extent" id="Another-Bug">
<div class="nav-panel">
<p>
Next: <a href="Final-printed-graph.html" accesskey="n" rel="next">The Printed Graph</a>, Previous: <a href="mapcar.html" accesskey="p" rel="prev">The <code class="code">mapcar</code> Function</a>, Up: <a href="Print-Whole-Graph.html" accesskey="u" rel="up">Printing the Whole Graph</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="appendixsubsec" id="Another-Bug-_2026-Most-Insidious">C.4.5 Another Bug &hellip; Most Insidious</h4>
<a class="index-entry-id" id="index-Bug_002c-most-insidious-type"></a>
<a class="index-entry-id" id="index-Insidious-type-of-bug"></a>

<p>I said &ldquo;almost ready to print&rdquo;!  Of course, there is a bug in the
<code class="code">print-graph</code> function &hellip;  It has a <code class="code">vertical-step</code>
option, but not a <code class="code">horizontal-step</code> option.  The
<code class="code">top-of-range</code> scale goes from 10 to 300 by tens.  But the
<code class="code">print-graph</code> function will print only by ones.
</p>
<p>This is a classic example of what some consider the most insidious
type of bug, the bug of omission.  This is not the kind of bug you can
find by studying the code, for it is not in the code; it is an omitted
feature.  Your best actions are to try your program early and often;
and try to arrange, as much as you can, to write code that is easy to
understand and easy to change.  Try to be aware, whenever you can,
that whatever you have written, <em class="emph">will</em> be rewritten, if not soon,
eventually.  A hard maxim to follow.
</p>
<p>It is the <code class="code">print-X-axis-numbered-line</code> function that needs the
work; and then the <code class="code">print-X-axis</code> and the <code class="code">print-graph</code>
functions need to be adapted.  Not much needs to be done; there is one
nicety: the numbers ought to line up under the tic marks.  This takes
a little thought.
</p>
<p>Here is the corrected <code class="code">print-X-axis-numbered-line</code>:
</p>
<div class="example smallexample">
<div class="group"><pre class="example-preformatted">(defun print-X-axis-numbered-line
  (number-of-X-tics X-axis-leading-spaces
   &amp;optional horizontal-step)
  &quot;Print line of X-axis numbers&quot;
  (let ((number X-axis-label-spacing)
        (horizontal-step (or horizontal-step 1)))
</pre></div><div class="group"><pre class="example-preformatted">    (insert X-axis-leading-spaces)
    ;; <span class="r">Delete extra leading spaces.</span>
    (delete-char
     (- (1-
         (length (number-to-string horizontal-step)))))
    (insert (concat
             (make-string
</pre></div><div class="group"><pre class="example-preformatted">              ;; <span class="r">Insert white space.</span>
              (-  (* symbol-width
                     X-axis-label-spacing)
                  (1-
                   (length
                    (number-to-string horizontal-step)))
                  2)
              ? )
             (number-to-string
              (* number horizontal-step))))
</pre></div><div class="group"><pre class="example-preformatted">    ;; <span class="r">Insert remaining numbers.</span>
    (setq number (+ number X-axis-label-spacing))
    (while (&gt; number-of-X-tics 1)
      (insert (X-axis-element
               (* number horizontal-step)))
      (setq number (+ number X-axis-label-spacing))
      (setq number-of-X-tics (1- number-of-X-tics)))))
</pre></div></div>

<p>If you are reading this in Info, you can see the new versions of
<code class="code">print-X-axis</code> <code class="code">print-graph</code> and evaluate them.  If you are
reading this in a printed book, you can see the changed lines here
(the full text is too much to print).
</p>

<div class="example smallexample">
<div class="group"><pre class="example-preformatted">(defun print-X-axis (numbers-list horizontal-step)
  &quot;Print X axis labels to length of NUMBERS-LIST.
Optionally, HORIZONTAL-STEP, a positive integer,
specifies how much an X  axis label increments for
each column.&quot;
</pre></div><div class="group"><pre class="example-preformatted">;; Value of symbol-width and full-Y-label-width
;; are passed by print-graph.
  (let* ((leading-spaces
          (make-string full-Y-label-width ? ))
       ;; symbol-width <span class="r">is provided by</span> graph-body-print
       (tic-width (* symbol-width X-axis-label-spacing))
       (X-length (length numbers-list))
</pre></div><div class="group"><pre class="example-preformatted">       (X-tic
        (concat
         (make-string
          ;; <span class="r">Make a string of blanks.</span>
          (-  (* symbol-width X-axis-label-spacing)
              (length X-axis-tic-symbol))
          ? )
</pre></div><div class="group"><pre class="example-preformatted">         ;; <span class="r">Concatenate blanks with tic symbol.</span>
         X-axis-tic-symbol))
       (tic-number
        (if (zerop (% X-length tic-width))
            (/ X-length tic-width)
          (1+ (/ X-length tic-width)))))
</pre></div><pre class="example-preformatted">

</pre><div class="group"><pre class="example-preformatted">    (print-X-axis-tic-line
     tic-number leading-spaces X-tic)
    (insert &quot;\n&quot;)
    (print-X-axis-numbered-line
     tic-number leading-spaces horizontal-step)))
</pre></div></div>

<div class="example smallexample">
<div class="group"><pre class="example-preformatted">(defun print-graph
  (numbers-list &amp;optional vertical-step horizontal-step)
  &quot;Print labeled bar graph of the NUMBERS-LIST.
The numbers-list consists of the Y-axis values.
</pre></div><pre class="example-preformatted">

</pre><div class="group"><pre class="example-preformatted">Optionally, VERTICAL-STEP, a positive integer,
specifies how much a Y axis label increments for
each line.  For example, a step of 5 means that
each row is five units.
</pre></div><pre class="example-preformatted">

</pre><div class="group"><pre class="example-preformatted">Optionally, HORIZONTAL-STEP, a positive integer,
specifies how much an X  axis label increments for
each column.&quot;
  (let* ((symbol-width (length graph-blank))
         ;; <code class="code">height</code> <span class="r">is both the largest number</span>
         ;; <span class="r">and the number with the most digits.</span>
         (height (apply 'max numbers-list))
</pre></div><div class="group"><pre class="example-preformatted">         (height-of-top-line
          (if (zerop (% height Y-axis-label-spacing))
              height
            ;; <span class="r">else</span>
            (* (1+ (/ height Y-axis-label-spacing))
               Y-axis-label-spacing)))
</pre></div><div class="group"><pre class="example-preformatted">         (vertical-step (or vertical-step 1))
         (full-Y-label-width
          (length
           (concat
            (number-to-string
             (* height-of-top-line vertical-step))
            Y-axis-tic))))
</pre></div><div class="group"><pre class="example-preformatted">    (print-Y-axis
     height-of-top-line full-Y-label-width vertical-step)
    (graph-body-print
        numbers-list height-of-top-line symbol-width)
    (print-X-axis numbers-list horizontal-step)))
</pre></div></div>


</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Final-printed-graph.html">The Printed Graph</a>, Previous: <a href="mapcar.html">The <code class="code">mapcar</code> Function</a>, Up: <a href="Print-Whole-Graph.html">Printing the Whole Graph</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
